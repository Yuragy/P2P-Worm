#ifndef EXPLOIT_DB_H
#define EXPLOIT_DB_H

#include "cve_db.h"
#include <stddef.h>

typedef struct {
    char *id;    // exploit internal id
    char *cve;   // CVE - YYYY - NNNN
    char *desc;  // short description
    char *path;  // path or command
} exploit_item_t;

typedef struct {
    exploit_item_t *items;
    size_t          count;
} exploit_db_t;

int  exploit_db_load(exploit_db_t *db, const char *csv_path);
void exploit_db_free(exploit_db_t *db);
void exploit_db_print_for_cves(const exploit_db_t *db, const cve_list_t *cves);

#endif // EXPLOIT_DB_H
